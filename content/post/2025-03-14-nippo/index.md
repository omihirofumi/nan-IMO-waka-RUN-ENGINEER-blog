---
date: '2025-03-14T00:25:43+09:00'
tags:
- にっぽー
title: 'にっぽー'
---
## 今読んでる
[戦略的思考トレーニング 目標実現力が飛躍的にアップする37問 (PHPビジネス新書) | 三坂 健 |本 | 通販 | Amazon](https://www.amazon.co.jp/%E6%88%A6%E7%95%A5%E7%9A%84%E6%80%9D%E8%80%83%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0-%E7%9B%AE%E6%A8%99%E5%AE%9F%E7%8F%BE%E5%8A%9B%E3%81%8C%E9%A3%9B%E8%BA%8D%E7%9A%84%E3%81%AB%E3%82%A2%E3%83%83%E3%83%97%E3%81%99%E3%82%8B37%E5%95%8F-PHP%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E6%96%B0%E6%9B%B8-%E4%B8%89%E5%9D%82-%E5%81%A5/dp/4569850774)  
まだ読み始めたばかりだけど、  
- 目標を達成するためにはどうするか
  - 戦略を立てる
    - 戦略とは何か：目標を達成するためのシナリオ
  - 作戦
    - シナリオを分解した時の各プロジェクト
    - ストーリーでいう各章
  - 戦術
    - プロジェクトをうまく成功させるための方法


## ドメイン駆動開発
### 二つの案件で導入してみての所感  
なんでもかんでも値オブジェクトにしてってやるのは結構きつい。  
きついっていうのはただめんどくさいってこと。  
ここでよくないのは、何でもかんでも値オブジェクトを作ることではなくて、**設計せず**になんでも値オブジェクトにしてしまうこと。  
ドメイン駆動開発で最も大事なのは、**設計・モデリング**。これに尽きる。  
まあ、でもドメイン駆動開発は改善していくことが前提なので、最初から完璧な設計をする必要はない。

## App Runner vs ECS for Fargate
[前に](/post/2025-03-11-nippo)、App Runner vs ECS for FargateでFargateを選んだが、結局App Runnerになった。  
理由は、httpsでwebサービスを公開したくて、ただドメインは自動で払い出して欲しかった。  
App Runnerはここを面倒見てくれるので、App Runnerにした。  
なので、VPC ConnectorとNAT Gatewayを使ってVPCから外部に出れるようにした。  

Google CloudだとCloud Runを基本的に使っていてAWSほどネットワークを意識しないので、ネットワーク意識して使うのも楽しいね。

## Gitリポジトリに繋げない状態で、Private SubnetのRDSにマイグレートする方法
現状、BacklogのGitでやっていて、今後Github or Gitlabに移行する予定。  
なので、とりあえずマイグレートできれはなんでもよく、構築含めて一番楽にマイグレートできる構成がよかった。  
CI/CDはやったほうがいいけど、検証段階であったりしてCI/CDの構築コストがメリットを上回るので、Githubなどに移行できたらCI/CDを構築する予定。  

- 踏み台サーバーとしてEC2をたて、ローカルからRDSにポートフォワードで繋げる←これにした
  - すごく単純で、ローカルから繋げるので楽
  - IaCするほどでもないので、コンソールでぽちぽちするのが一番簡単だったこれを採用
- EC2にDockerを入れて、イメージプルして、マイグレート実行する
  - イメージビルドにして、LambdaをVPCに繋げておいて、マイグレート実行する
  - Dockerのインストールがめんどくさい。ユーザデータで書いちゃえばいいけど。
- Lambdaにイメージデプロイして、マイグレート実行する
  - イメージビルドにして、LambdaをVPCに繋げておいて、マイグレート実行するだけでいいので実行時が楽
  - lambda用のランタイムは癖があって、イメージを作るのがめんどくさい
- Code Buildでイメージビルドして、マイグレート実行する
  - 今後CI/CDを構築する時の土台になれる
  - VPCやNAT Gatewayの設定がめんどくさかった
